# analytics.py
import pandas as pd
import glob

df = pd.concat([pd.read_csv(f) for f in glob.glob("data/placement_history/*.csv")], ignore_index=True)
# Example columns: batch_year, applied_company, shortlisted (0/1), ppi (0/1)
summary = df.groupby("batch_year").agg(
    total_apps=("student_id","count"),
    ppi_count=("ppi","sum"),
    shortlist_count=("shortlisted","sum")
).reset_index()
summary["ppi_rate"] = summary["ppi_count"] / summary["total_apps"] * 100
summary["shortlist_rate"] = summary["shortlist_count"] / summary["total_apps"] * 100
print(summary)
print("5-year aggregate PPI rate:", df["ppi"].sum() / df["student_id"].nunique() * 100)
